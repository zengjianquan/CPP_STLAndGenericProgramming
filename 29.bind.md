## ç®€ä»‹

![image-20230709164612928](image/image-20230709164612928.png)

å¦‚ä¸Šå›¾ï¼Œè¿™æ˜¯ä¸€ä»½æ›¿ä»£å…³ç³»è¡¨ï¼Œè¡¨ç¤ºä¸ºå³è¾¹çš„ç±»å‹å°†ä¼šè¢«å·¦è¾¹å¯¹åº”çš„ç±»å‹è¿›è¡Œæ›¿ä»£ã€‚

åœ¨ä»‹ç»å®Œ [binder2nd](27.Binder2nd) ä¹‹åï¼Œå…¶å®æœ‰æåˆ°è¯´ `bind` å°†ä¼šå»å–ä»£è¿™äº›ç»‘å®šæ–¹æ³•ã€‚æ¥ä¸‹æ¥å°±ä¼šè¯¦ç»†ä»‹ç»è¿™ä¸ªé€‚é…å™¨ã€‚

## ä½¿ç”¨

`std::bind` æ˜¯ c++11 æä¾›çš„é€‚é…å™¨ã€‚

> åœ¨è¿™é‡Œä¾¯æ·è€å¸ˆæ— è®ºæ˜¯åœ¨è¯¾ä»¶è¿˜æ˜¯è¯´åœ¨è¯¾å ‚ä¸Šçš„å†…å®¹ï¼Œåªä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ `std::bind`ï¼Œè€Œæ²¡æœ‰å»ä»‹ç»å…·ä½“å®ç°ã€‚
>
> è¿™é‡Œç¬”è€…è®¤ä¸ºè¿™é‡Œæ¶‰åŠäº† c++11 çš„ä¸€äº›æ–°ç‰¹æ€§ï¼Œä¾‹å¦‚è¯´ å¯å˜å‚æ•°æ¨¡æ¿ã€ç±»å‹æ¨å¯¼ç­‰ç­‰ï¼Œè¿™äº›å†…å®¹æ–°ç‰¹æ€§å¯èƒ½ä¼šåœ¨c++11-14 æ–°ç‰¹æ€§ç³»åˆ—è¯¾ç¨‹ä¸­ä¼šè¢«ä»‹ç»ï¼Œåœ¨è¿™é‡Œä»‹ç»ä¼šå»¶ç”³å¤ªå¤šå†…å®¹ã€‚
>
> å…ˆä¸ç®¡è¿™ä¹ˆå¤šï¼Œç›´æ¥çœ‹å¦‚ä½•ä½¿ç”¨å§ğŸ˜‚~

![image-20230709165233509](image/image-20230709165233509.png)

å¦‚ä¸Šå›¾ï¼Œåœ¨<u>*å·¦ä¸‹è§’*</u>éƒ¨åˆ†ä»‹ç»åˆ°ï¼Œ`std::bind` å¯ä»¥ç»‘å®šå¦‚ä¸‹å†…å®¹ï¼š

> 1.**å‡½æ•°**
>
> 2.**å‡½æ•°å¯¹è±¡**ï¼Œå³ä»¿å‡½æ•°
>
> 3.**æˆå‘˜å‡½æ•°**ï¼Œè¿™æ˜¯ `binder2nd` æˆ–è€…è¯´ `binder1st` ä¸­éƒ½æ²¡æœ‰çš„ã€‚
>
> 4.**ç±»æˆå‘˜**ï¼Œä¸€ä¸ªç±»ä¸­çš„æˆå‘˜ä¹Ÿå¯ä»¥è¢«ç»‘å®šï¼Ÿï¼

å…³äºç¬¬3ã€4ç‚¹ï¼Œç°åœ¨ä¼šæœ‰å¾ˆå¤šç–‘æƒ‘ï¼Œå…ˆæ¥çœ‹ä¾‹å­ï¼š

### å®šä¹‰

åœ¨ä¸Šå›¾å·¦ä¾§ï¼Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•°å’Œä¸€ä¸ªç±»å‹ã€‚

```C++
double my_divide(double, double);

struct MyPair{
    double a, b;
    double multiply() { return  a * b; }
};
```

### ç»‘å®š

#### å ä½ç¬¦

```C++
auto fn_five = std::bind(my_divide, 10, 2);
cout << fn_five() << endl;	// 5
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨ `bind` ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æˆ‘ä»¬æå‰å®šä¹‰çš„é™¤æ³•å‡½æ•° `my_divide`ï¼Œä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å¯¹è±¡ `fn_five`ï¼Œè°ƒç”¨æ—¶ä½¿ç”¨è°ƒç”¨æ“ä½œç¬¦å³å¯ï¼Œå³ `fn_five()`ã€‚

ç„¶è€Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ï¼ŒçœŸæ­£çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

```C++
auto fn_half = std::bind(my_divide, std::placeholders::_1, 2);
cout << fn_half(10) << endl;	//5
```

å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„ `bind` å°†ç¬¬äºŒå‚æ•°ç»‘å®šä¸º 2ï¼Œè€Œç¬¬ä¸€å‚æ•°æ˜¯ä¸€ä¸ª<u>***å ä½ç¬¦***</u>ï¼Œ`std::placeholders::_1`ï¼Œè¿™ä¸ªå ä½ç¬¦çš„æ„æ€ä¸ºï¼š<u>***åœ¨è°ƒç”¨æ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªå‚æ•°æ”¾ç½®åœ¨å ä½ç¬¦ `std::placeholders::_1` çš„ä½ç½®ã€‚***</u>

![image-20230709170814601](image/image-20230709170814601.png)

å¦å¤–ï¼Œå…³äºå ä½ç¬¦ï¼Œåœ¨ VC ä¸­æœ‰ `_20` ä¹‹å¤šï¼Œå¦‚ä¸Šå›¾ã€‚

```C++
auto fn_invert = std::bind(my_divide, std::placeholders::_2, std::placeholders::_1);
cout << fn_invert(10, 2) << endl;	//0.2
```

æ›´å¤šå…³äºå ä½ç¬¦çš„ç”¨æ³•ï¼Œå¦‚ä¸Šè¿°ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç»“æœä¸º `0.2`ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç»‘å®šæ—¶ï¼Œ<u>***å°†è°ƒç”¨æ—¶çš„ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ å…¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥***</u>ã€‚

> æ³¨æ„ï¼Œè¿™é‡Œç¬”è€…ä¸€ç›´å¼ºè°ƒçš„æ˜¯ <u>**è°ƒç”¨æ—¶**</u>ï¼Œå’Œç»‘å®šæ—¶çš„å‚æ•°æ¬¡åºä¸åŒï¼Œå ä½ç¬¦å†³å®šçš„æ˜¯è°ƒç”¨åçš„å‚æ•°ä¼ é€’æ¬¡åºã€‚

> åœ¨è¿™é‡Œä¾¯æ·è€å¸ˆå¹¶æ²¡æœ‰è¿½ç©¶ `placeholders` å’Œ `bind` å¦‚ä½•ç»“åˆï¼Œè¿™é‡Œä¹Ÿä¸å†æ·±ç©¶ï¼Œåç»­æœ‰æœºä¼šç¬”è€…å†è¿›è¡Œè¡¥å……å§ï¼ˆæŒ–å‘ï¼‰

#### è¿”å›å€¼

```c++
auto fn_rounding = std::bind<int>(my_divide, std::placeholders::_1, std::placeholders::_2);
cout << fn_rounding(10, 3) << endl;	//3
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œåˆ¶å®šäº† `bind` çš„è¿”å›å€¼ï¼ˆ`std::bind<int>`ï¼‰ï¼Œè‹¥å‡½æ•°è¿”å›å€¼å’ŒæŒ‡å®šçš„è¿”å›å€¼èƒ½å¤Ÿè¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚

#### æˆå‘˜å‡½æ•°

```C++
MyPair ten_tow {10, 2};

//std::placeholders::_1 å¿…é¡»æ˜¯ä¸ª object çš„åœ°å€
auto bound_memfn = std::bind(&MyPair::multiply, std::placeholders::_1);
cout << bound_memfn(ten_tow) << endl;	//20
```

å‚è€ƒ <u>C++é¢å‘å¯¹è±¡é«˜çº§å¼€å‘.Part1.5.æ“ä½œç¬¦é‡è½½ä¸ä¸´æ—¶å¯¹è±¡</u>ï¼Œè¿™é‡Œä»‹ç»äº†åœ¨ç±»æˆå‘˜å‡½æ•°ä¸­ï¼Œç¼–è¯‘å™¨ä¼š<u>***éšå¼çš„å°†æˆå‘˜å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ this æŒ‡é’ˆ***</u>ï¼Œæˆå‘˜å‡½æ•°é€šè¿‡ `this` æŒ‡é’ˆè·å–æˆå‘˜ã€‚

æ‰€ä»¥è¿™é‡Œçš„ `bind` å¾ˆç¬¦åˆè¿™ä¸ªç†å¿µï¼Œå°† object æœ¬èº«ä½œä¸º this æŒ‡é’ˆä¼ å…¥ï¼Œç”¨äºåœ¨è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œé€šè¿‡ this æŒ‡é’ˆæ¥è·å–æ•°æ®æˆå‘˜ã€‚

æˆ–è€…è¿™æ ·ç†è§£ä¹Ÿå¯ä»¥ï¼Œé€šè¿‡ object è°ƒç”¨å…¶æˆå‘˜å‡½æ•°æ—¶ï¼š`ten_tow.MyPair::multiply()`ã€‚å°†å‰é¢çš„å¯¹è±¡ä¼ å…¥ï¼Œæ‰èƒ½å¤Ÿæ­£ç¡®çš„è°ƒç”¨æˆå‘˜å‡½æ•°ã€‚

> ä¸¤ç§ç†è§£æ–¹å¼è¿™é‡Œç¬”è€…è·Ÿå€¾å‘äºç¬¬ä¸€ç§ï¼Œä¸çŸ¥é“å„ä½è¯»è€…æ€ä¹ˆç†è§£ï¼ŸğŸ˜“

#### æˆå‘˜å¯¹è±¡

```C++
auto bound_memfn = std::bind(&MyPair::a, ten_tow);
cout << bound_memfn() << endl;	//10
```

ä¸Šé¢çš„ä»£ç ä¸­æ²¡æœ‰ä½¿ç”¨å ä½ç¬¦ï¼Œè€Œæ˜¯ç›´æ¥ç»‘å®šçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æ—¶å°±æ²¡æœ‰å¿…è¦å»ç»‘å®šå¯¹è±¡äº†ã€‚å’Œç»‘å®šæˆå‘˜å‡½æ•°ç±»ä¼¼ã€‚

ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<u>**æˆå‘˜å¿…é¡»å¯è®¿é—®ï¼Œå¦åˆ™ä¸èƒ½ç›´æ¥ç»‘å®š**</u>ã€‚